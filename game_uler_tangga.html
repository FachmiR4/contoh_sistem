<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ular Tangga Multiplayer — Fixed</title>
  <style>
    :root{
      --accent:#1e40af;
      --btn-grad: linear-gradient(90deg,#4f8cff 0%,#1e40af 100%);
    }
    *{box-sizing:border-box}
    body {
      text-align: center;
      font-family: 'Segoe UI', Arial, sans-serif;
      background: linear-gradient(120deg, #e0e7ff 0%, #f4f4f4 100%);
      margin: 0;
      min-height: 100vh;
      padding-bottom: 40px;
    }
    h1 {
      color: var(--accent);
      margin-top: 20px;
      margin-bottom: 8px;
      letter-spacing: 1px;
      font-size: clamp(1.25rem, 2.2vw, 2.2rem);
    }

    #controls {
      margin: 16px auto;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 2px 12px rgba(30,64,175,0.08);
      padding: 14px;
      max-width: 720px;
      width: calc(100% - 32px);
    }
    label{ font-weight:600; color:#0f172a; display:block; margin-bottom:6px; }
    #playerCount { width:72px; padding:6px; border-radius:8px; border:1px solid #e2e8f0; font-size:1rem; }
    .name-input { margin:6px 0; padding:8px 10px; border-radius:8px; border:1px solid #e2e8f0; width:100%; max-width:360px; }
    .controls-row { display:flex; gap:8px; align-items:center; justify-content:center; flex-wrap:wrap; margin-bottom:8px; }

    .btn {
      padding:10px 16px; margin:6px 4px; font-size:15px; border-radius:8px; border: none;
      background: var(--btn-grad); color:#fff; font-weight:700; cursor:pointer;
      box-shadow: 0 4px 14px rgba(30,64,175,0.12);
    }
    .btn:disabled { opacity:0.6; cursor:not-allowed; transform:none; box-shadow:none; }

    #turnInfo { font-size:1rem; color:var(--accent); margin-top:8px; font-weight:600; }
    #diceResult{ font-size:0.95rem; margin:4px 0 0; color:#064e3b; font-weight:700; }
    #diceImage img{ width:54px; height:54px; display:block; margin:8px auto 0; }

    /* Board */
    #board {
      background-image: url('ulertangga_versi2.jpeg');
      background-size: cover;
      background-position: center;
      width: min(720px, 96vw);
      height: min(770px, 96vw);
      margin: 20px auto;
      position: relative;
      border-radius: 12px;
      box-shadow: 0 6px 28px rgba(2,6,23,0.12);
      border: 3px solid rgba(14,50,105,0.08);
      overflow: hidden;
    }

    .player {
      width: clamp(20px, 6vw, 36px);
      height: clamp(20px, 6vw, 36px);
      border-radius: 50%;
      position: absolute;
      transform: translate(-50%, -50%);
      text-align: center;
      line-height: clamp(20px, 6vw, 36px);
      color: white;
      font-size: clamp(10px, 3.2vw, 14px);
      font-weight: 800;
      border: 2px solid #fff;
      box-shadow: 0 4px 10px rgba(2,6,23,0.18);
      z-index: 5;
      transition: left 220ms cubic-bezier(.2,.9,.2,1), top 220ms cubic-bezier(.2,.9,.2,1), transform 200ms;
      display:flex; align-items:center; justify-content:center;
    }

    .player.pop {
      transform: translate(-50%, -50%) scale(1.18);
      transition: transform 160ms;
    }

    #log {
      max-height: 220px;
      overflow-y: auto;
      background: #fff;
      padding: 10px;
      border: 1px solid #e6eef8;
      width: min(720px, 96vw);
      margin: 8px auto 0;
      text-align: left;
      border-radius: 8px;
      font-size: 0.95rem;
      box-shadow: 0 3px 12px rgba(30,64,175,0.06);
    }

    /* Penalty modal */
    .modal-backdrop{
      position:fixed; inset:0; background:rgba(2,6,23,0.45); display:none; align-items:center; justify-content:center; z-index:1200;
    }
    .modal {
      width:min(560px,94vw); background:#fff; border-radius:12px; padding:14px; box-shadow:0 12px 48px rgba(2,6,23,0.28);
    }
    .modal h3{ margin:0 0 8px }
    .pen-list{ display:flex; flex-direction:column; gap:8px; max-height:260px; overflow:auto; padding:6px }
    .pen-row{ display:flex; gap:8px; }
    .pen-row input{ flex:1; padding:8px; border-radius:8px; border:1px solid #e6eef8 }
    .icon-btn{ background:transparent; border:none; color:#ef4444; font-weight:800; cursor:pointer; padding:6px }

    /* Wheel */
    .wheel-backdrop{ position:fixed; inset:0; background:rgba(2,6,23,0.6); display:none; align-items:center; justify-content:center; z-index:1300 }
    .wheel-card{ background:#fff; border-radius:14px; padding:18px; display:flex; flex-direction:column; align-items:center; gap:12px }
    .wheel-wrap{ width:360px; height:360px; position:relative }
    .wheel{ width:100%; height:100%; border-radius:50%; overflow:hidden; position:relative; transition:transform 4s cubic-bezier(.12,.84,.2,1) }
    .wheel-canvas{ position:absolute; inset:0 }
    .spin-btn{ position:absolute; left:50%; top:50%; transform:translate(-50%,-50%); z-index:40; background:linear-gradient(180deg,#fff,#e6eef8); border-radius:50%; width:96px; height:96px; display:flex; align-items:center; justify-content:center; font-weight:800; cursor:pointer; box-shadow:0 10px 30px rgba(2,6,23,0.16) }
    .pointer{ position:absolute; top:-12px; left:50%; transform:translateX(-50%); width:0; height:0; border-left:14px solid transparent; border-right:14px solid transparent; border-bottom:18px solid #ef4444; z-index:200 }

    /* small responsive */
    @media (max-width:640px) {
      .wheel-wrap{ width:260px; height:260px }
      .name-input{ width:140px }
      .spin-btn{ width:72px; height:72px }
    }

  </style>
</head>
<body>
  <h1>Game Ular Tangga — Multiplayer</h1>

  <div id="controls" aria-label="controls">
    <div class="controls-row" style="justify-content:space-between;">
      <div style="display:flex;gap:12px;align-items:center;">
        <div>
          <label for="playerCount">Jumlah Pemain</label>
          <input type="number" id="playerCount" min="2" max="6" value="2">
        </div>
        <div>
          <label>&nbsp;</label>
          <div style="display:flex; gap:8px;">
            <button id="startBtn" class="btn">Mulai</button>
            <button id="rollBtn" class="btn" disabled>Lempar Dadu</button>
          </div>
        </div>
      </div>

      <div style="display:flex;gap:8px;align-items:center;">
        <button id="openPenaltyBtn" class="btn">Atur Hukuman</button>
        <button id="resetBtn" class="btn">Reset</button>
      </div>
    </div>

    <div id="playerNames" style="display:flex; flex-direction:column; align-items:center; margin-top:8px;"></div>

    <p id="turnInfo" aria-live="polite"></p>
    <div id="diceImage" aria-hidden="true"></div>
    <p id="diceResult" aria-live="polite"></p>
  </div>

  <div id="board" role="application" aria-label="Papan Ular Tangga"></div>
  <div id="log" aria-live="polite"></div>

  <!-- Penalty modal -->
  <div id="penModal" class="modal-backdrop" role="dialog" aria-modal="true">
    <div class="modal" role="document">
      <h3>Atur Hukuman</h3>
      <p style="color:#475569;font-weight:600;margin:6px 0 10px">Tambahkan hukuman yang akan diberikan kepada pemain kalah.</p>
      <div class="pen-list" id="penList"></div>
      <div style="display:flex;gap:8px;margin-top:8px;justify-content:flex-end">
        <button id="addPenBtn" class="btn">+ Tambah Hukuman</button>
        <button id="savePenBtn" class="btn">Simpan</button>
        <button id="cancelPenBtn" class="btn">Batal</button>
      </div>
    </div>
  </div>

  <!-- Wheel spinner modal -->
  <div id="wheelModal" class="wheel-backdrop">
    <div class="wheel-card" role="dialog" aria-modal="true">
      <div class="pointer" aria-hidden="true"></div>
      <div class="wheel-wrap">
        <div id="wheel" class="wheel" role="img" aria-label="Roda Pemain">
          <canvas id="wheelCanvas" class="wheel-canvas"></canvas>
        </div>
        <div id="spinBtn" class="spin-btn">SPIN</div>
      </div>
      <div id="wheelInfo" style="color:#475569;font-weight:600">Klik <strong>SPIN</strong> untuk memilih pemain yang kalah</div>
      <div style="display:flex;gap:8px"><button id="closeWheel" class="btn">Tutup</button></div>
    </div>
  </div>

  <script src="assets/ultgV1.js"></script>
</body>
</html>
